#!/usr/bin/env python3
"""
Simple test to verify CAN bus communication
"""
import can
import time

def test_can_communication():
    print("Testing CAN bus communication...")
    
    try:
        bus = can.interface.Bus(channel='vcan0', bustype='virtual')
        
        test_msg = can.Message(
            arbitration_id=0x123,
            data=[0x11, 0x22, 0x33, 0x44],
            is_extended_id=False
        )
        
        bus.send(test_msg)
        print("✅ Test message sent successfully!")
        
        print("Listening for messages (5 seconds)...")
        start_time = time.time()
        
        while time.time() - start_time < 5:
            msg = bus.recv(timeout=1.0)
            if msg is not None:
                print(f"✅ Received message: ID=0x{msg.arbitration_id:03X}")
                
        bus.shutdown()
        print("CAN bus test completed!")
        
    except Exception as e:
        print(f"❌ Error: {e}")

if __name__ == "__main__":
    test_can_communication()